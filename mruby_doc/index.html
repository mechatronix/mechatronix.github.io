<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!file.README.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h1>Introduction to mxint functionality</h1>

<p>The <code>mxint</code> command is a multi-language interpreter used for dealing with C/C++ code generated by XOptima Maple module.</p>

<p>It has three main functionalities:</p>

<ol>
<li>compile the generated code into a dynamic library and a static library, to be used by custom code written by the user</li>
<li>provide a powerful way for describing problem data as ruby scripts that are loaded by the library generated in the previous step</li>
<li>allow to quickly write a script using the flexible and powerful ruby language that dynamically links at runtime with the problem dynamic library generated in 1. and control the execution of the solver, manage the output, and even plan and run parametric investigations.</li>
</ol>

<p><strong>NOTE</strong> the main language provided by <code>mxint</code> is Ruby, although the interpreter itself is <em>mruby</em>, which is an embedded, simplified, and faster version of it. The syntax is compatible to Ruby 1.9, although the interpreter has some notable difference, including the lack of support for Ruby gems (libraries).</p>

<p>The powerful mechanism described in 3. is enabled by the fact that the dynamic library generated by XOptima also includes C entry points that allow the mruby interpreter to dynamically load the compiled library at runtime (via dlopen). This works regardless of the platform. </p>

<p>Nothe though that, if the ruby scripts are portable amongst different platforms, the <em>compiled</em> dynamic libraries are not, and you will need to recompile the source code for each platform. The code generated by Maple/XOptima, though, can be moved to a different platform and recompiled without editing.</p>

<p>The <code>mxint</code> command also embeds a Lua 4.2 interpreter. This allows the user to also write data files in lua, although that interpreter currently does not offer the same functionalities as the Ruby one.</p>

<h2>Example script</h2>

<p>The following example corresponds to a simplified version of the basic template generated by XOptima.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'>#!/usr/bin/env mxint
</span><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mechatronix</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Set the model name
</span><span class='id identifier rubyid_problem_name'>problem_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Train</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># Compile the scripts, unless the library already exists
</span><span class='comment'># the command line flag &#39;-f&#39; forces recompilation
</span><span class='kw'>if</span> <span class='op'>!</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lib/lib</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_problem_name'>problem_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.dylib</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='const'>ARGV</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-f</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>then</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>build</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_compiler'>compiler</span> <span class='op'>=</span> <span class='const'>MXBuilder</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_problem_name'>problem_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_compiler'>compiler</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span>
<span class='kw'>end</span>

<span class='comment'># load the data file
</span><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./data/Train_Data.rb</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Link the library
</span><span class='id identifier rubyid_ocp'>ocp</span> <span class='op'>=</span> <span class='const'>Mechatronix</span><span class='op'>::</span><span class='const'>OCPSolver</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lib/lib</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_problem_name'>problem_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='const'>Mechatronix</span><span class='op'>::</span><span class='const'>DYLIB_EXT</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># Setup the solver
</span><span class='id identifier rubyid_ocp'>ocp</span><span class='period'>.</span><span class='id identifier rubyid_setup'>setup</span>

<span class='comment'># Calculate the OCP solution. Result is into ocp.ocp_solution
</span><span class='id identifier rubyid_ocp'>ocp</span><span class='period'>.</span><span class='id identifier rubyid_solve'>solve</span>

<span class='comment'># Write results
</span><span class='kw'>unless</span> <span class='id identifier rubyid_ocp'>ocp</span><span class='period'>.</span><span class='id identifier rubyid_ocp_solution'>ocp_solution</span><span class='lbracket'>[</span><span class='symbol'>:Error</span><span class='rbracket'>]</span> <span class='kw'>then</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_ocp'>ocp</span><span class='period'>.</span><span class='id identifier rubyid_ocp_solution'>ocp_solution</span><span class='lbracket'>[</span><span class='symbol'>:converged</span><span class='rbracket'>]</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_ocp'>ocp</span><span class='period'>.</span><span class='id identifier rubyid_write_ocp_solution'>write_ocp_solution</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_problem_name'>problem_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_OCP_result.txt</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_ocp'>ocp</span><span class='period'>.</span><span class='id identifier rubyid_write_ocp_solution'>write_ocp_solution</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_problem_name'>problem_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_OCP_result_NOT_CONVERGED.txt</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>else</span>
  <span class='id identifier rubyid_ocp'>ocp</span><span class='period'>.</span><span class='id identifier rubyid_write_ocp_solution'>write_ocp_solution</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_problem_name'>problem_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>_OCP_result_NOT_CONVERGED.txt</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_ocp'>ocp</span><span class='period'>.</span><span class='id identifier rubyid_ocp_solution'>ocp_solution</span><span class='lbracket'>[</span><span class='symbol'>:Error</span><span class='rbracket'>]</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_figlet'>figlet</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>All Done Folks!</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<h2>Example data file</h2>

<p>To be done.</p>
</div></div>

    <div id="footer">
  Generated on Thu Mar 26 13:09:14 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.0.0).
</div>

  </body>
</html>